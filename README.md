# 📦 자동 발주 파일 생성기

여러 마켓(네이버, 쿠팡, 자사몰, ESM, 11번가)의 발주 파일을 자동으로 병합하여 CJ택배 발주 파일 형태로 변환하는 웹 애플리케이션입니다.

## 🌐 온라인 서비스

**🚀 배포된 사이트: https://delivery-doumi.streamlit.app/**

누구나 접속해서 바로 사용 가능합니다! (로그인 불필요)

## 🚀 로컬 실행 방법

### 1. 필요한 패키지 설치
```bash
pip install -r requirements.txt
```

### 2. 웹 애플리케이션 실행
```bash
streamlit run app.py
```

### 3. 브라우저에서 접속
자동으로 브라우저가 열리며, `http://localhost:8501`에서 접속할 수 있습니다.

## 📖 사용법

### 📦 발주 파일 생성
1. **네이버 파일 암호 제거** (필요시)
   - 엑셀 파일 열기 → F12 → 도구 → 일반 옵션 → 비밀번호 삭제 → 저장

2. **파일 업로드**
   - 웹 페이지에서 각 마켓의 발주 파일을 선택 (여러 파일 동시 선택 가능)

3. **파일 생성**
   - "발주 파일 생성" 버튼 클릭

4. **다운로드**
   - 생성된 파일을 다운로드
   - 데이터 미리보기로 결과 확인

### 📋 주문관리 시트 생성 (신규 기능)
1. **CJ택배 파일 업로드**
   - CJ 배송 실적 출력 파일 (운송장번호와 고객주문번호 포함)

2. **마켓 주문시트 업로드**
   - 각 마켓의 주문 파일 업로드 (여러 개 가능)
   - 또는 위에서 업로드한 파일 재사용 (체크박스 선택)

3. **주문관리시트 생성**
   - "주문관리시트 생성" 버튼 클릭

4. **다운로드**
   - **주문관리시트**: 송장번호 매칭된 통합 시트
   - **쿠팡 발송 파일** (자동 생성): 쿠팡 원본 + 운송장번호
   - 데이터 미리보기로 결과 확인
   - 품목별 판매 집계 표 확인

5. **자동 기능**
   - 같은 주문번호의 제품 자동 통합 (예: OH 2개, PH 1개)
   - CJ 송장번호 자동 매칭
   - 발주파일과 동일한 순서로 정렬
   - 옥션/지마켓 자동 구분 (주문번호 패턴 기반)
   - 제품명 자동 분류 (OH, PH, SH, 케이블, 거치대 등)

## 📁 지원 마켓

- ✅ 네이버 스마트스토어
- ✅ 쿠팡 (DeliveryList)
- ✅ 와디즈 (발송 처리용 주문)
- ✅ 자사몰 (orders)
- ✅ ESM (지마켓/옥션)
- ✅ 11번가 (allList)

## 📄 출력 파일

- `MMDD_HH.xlsx`: 통합 발주 파일 (CJ택배 형식)
- `MMDD_HH_쿠팡_원본정렬.xlsx`: 쿠팡 파일 정렬본 (쿠팡 파일이 있는 경우)
- `주문관리_MMDD_HH.xlsx`: 주문관리 시트 (CJ 송장번호 매칭)
- `쿠팡발송_MMDD_HH.xlsx`: 쿠팡 발송 파일 (원본 서식 유지 + 운송장번호)

## 🛠️ 기술 스택

- Python 3.8+
- Streamlit (웹 인터페이스)
- Pandas (데이터 처리)
- OpenPyXL (엑셀 파일 처리)

## 📝 참고사항

- 파일명 시간 형식: MMDD_HH (예: 0205_15 = 2월 5일 오후 3시)
- 동일한 배송지로 여러 상품이 주문된 경우 자동으로 통합됩니다
- 주문관리시트: 같은 주문번호의 제품이 자동으로 합쳐집니다
- 제품명 자동 분류: OH, PH, SH, 케이블(일반), 케이블s, 휴대폰거치대, 차량번호판, 차량용망치, 도막측정기
- 정렬 순서: 마켓별(네이버→쿠팡→자사몰→ESM→11번가→와디즈) → 제품별(OH→PH→SH→기타)
- 옥션/지마켓 자동 구분: 주문번호가 2로 시작하면 옥션, 4로 시작하면 지마켓
